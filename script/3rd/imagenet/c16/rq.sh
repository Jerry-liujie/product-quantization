# hpc2.cse.cuhk.edu.hk:/research/jcheng2/xinyan/github/product-quantization> python run_imi_iregualr_rq.py
# Parameters: dataset = imagenet, topK = 1000, Ks = 256, metric = euclid
# load the base data data/imagenet/imagenet_base.fvecs,
# load the queries data/imagenet/imagenet_query.fvecs,
# load the ground truth data/imagenet/1000_imagenet_euclid_groundtruth.ivecs
#    Training the subspace: 0 / 2, 0 -> 75
#    Training the subspace: 1 / 2, 75 -> 150
# compress items with imi
# train hierarchy rqs on residuals
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 0,  residual average norm : 0.1700710505247116 max norm: 0.785703182220459 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 1,  residual average norm : 0.15650610625743866 max norm: 0.7191178202629089 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 2,  residual average norm : 0.14638935029506683 max norm: 0.5820121765136719 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 3,  residual average norm : 0.13822197914123535 max norm: 0.5622448325157166 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 4,  residual average norm : 0.13130638003349304 max norm: 0.5483657717704773 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 5,  residual average norm : 0.125118225812912 max norm: 0.46785134077072144 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 6,  residual average norm : 0.11963483691215515 max norm: 0.4538997411727905 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 7,  residual average norm : 0.11459799855947495 max norm: 0.3957192301750183 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 8,  residual average norm : 0.10998739302158356 max norm: 0.3792853057384491 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 9,  residual average norm : 0.10585124790668488 max norm: 0.3615860044956207 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 10,  residual average norm : 0.10199061781167984 max norm: 0.3402691185474396 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 11,  residual average norm : 0.09838540107011795 max norm: 0.31766360998153687 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 12,  residual average norm : 0.0950099527835846 max norm: 0.308129221200943 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 13,  residual average norm : 0.09183035790920258 max norm: 0.29617032408714294 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 14,  residual average norm : 0.08881928026676178 max norm: 0.2729800045490265 min norm: 0.0
# compress items with rq
# compress norm
#    Training the subspace: 0 / 1, 0 -> 1
# imi full sort
# probe
#
# probe 16 items
# hierarchy_index [ 0 16]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
   16,    1,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,  0.3100,
   16,   10,  0.0385,  0.0440,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,  0.0445,
   16,   20,  0.0203,  0.0243,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,  0.0255,
   16,   50,  0.0086,  0.0110,  0.0122,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,  0.0126,
   16,  100,  0.0049,  0.0065,  0.0077,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,  0.0081,
   16, 1000,  0.0008,  0.0013,  0.0018,  0.0022,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,  0.0023,
#
# probe 256 items
# hierarchy_index [  0 256]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
  256,    1,  0.8600,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,  0.8650,
  256,   10,  0.0885,  0.1285,  0.1600,  0.1750,  0.1815,  0.1830,  0.1830,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,  0.1835,
  256,   20,  0.0452,  0.0718,  0.0995,  0.1212,  0.1315,  0.1343,  0.1347,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,  0.1350,
  256,   50,  0.0185,  0.0319,  0.0502,  0.0687,  0.0809,  0.0878,  0.0895,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,  0.0899,
  256,  100,  0.0095,  0.0172,  0.0290,  0.0437,  0.0575,  0.0663,  0.0691,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,  0.0697,
  256, 1000,  0.0010,  0.0019,  0.0038,  0.0071,  0.0127,  0.0198,  0.0262,  0.0288,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,  0.0292,
#
# probe 1024 items
# hierarchy_index [   0 1024]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
 1024,    1,  0.9450,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,  0.9500,
 1024,   10,  0.0970,  0.1530,  0.2230,  0.2870,  0.3300,  0.3490,  0.3540,  0.3545,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,  0.3555,
 1024,   20,  0.0488,  0.0835,  0.1343,  0.1950,  0.2507,  0.2863,  0.2953,  0.2975,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,  0.2980,
 1024,   50,  0.0198,  0.0360,  0.0632,  0.1059,  0.1531,  0.1986,  0.2231,  0.2306,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,  0.2319,
 1024,  100,  0.0100,  0.0187,  0.0343,  0.0612,  0.0989,  0.1442,  0.1779,  0.1916,  0.1945,  0.1950,  0.1950,  0.1950,  0.1950,  0.1950,  0.1950,  0.1950,  0.1950,  0.1950,
 1024, 1000,  0.0010,  0.0020,  0.0039,  0.0077,  0.0150,  0.0281,  0.0487,  0.0740,  0.0929,  0.0984,  0.0988,  0.0988,  0.0988,  0.0988,  0.0988,  0.0988,  0.0988,  0.0988,
#
# probe 4096 items
# hierarchy_index [   0 4096]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
 4096,    1,  0.9800,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,
 4096,   10,  0.0995,  0.1680,  0.2665,  0.3815,  0.4895,  0.5670,  0.6025,  0.6145,  0.6165,  0.6175,  0.6175,  0.6175,  0.6175,  0.6175,  0.6175,  0.6175,  0.6175,  0.6175,
 4096,   20,  0.0498,  0.0897,  0.1527,  0.2455,  0.3595,  0.4695,  0.5343,  0.5590,  0.5645,  0.5653,  0.5653,  0.5653,  0.5653,  0.5653,  0.5653,  0.5653,  0.5653,  0.5653,
 4096,   50,  0.0199,  0.0380,  0.0701,  0.1256,  0.2076,  0.3141,  0.4149,  0.4703,  0.4887,  0.4917,  0.4918,  0.4918,  0.4918,  0.4918,  0.4918,  0.4918,  0.4918,  0.4918,
 4096,  100,  0.0100,  0.0194,  0.0372,  0.0696,  0.1244,  0.2084,  0.3109,  0.3977,  0.4362,  0.4433,  0.4443,  0.4444,  0.4444,  0.4444,  0.4444,  0.4444,  0.4444,  0.4444,
 4096, 1000,  0.0010,  0.0020,  0.0040,  0.0079,  0.0156,  0.0307,  0.0589,  0.1076,  0.1776,  0.2454,  0.2750,  0.2784,  0.2785,  0.2785,  0.2785,  0.2785,  0.2785,  0.2785,
#
# probe 16384 items
# hierarchy_index [    0 16384]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
16384,    1,  0.9950,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,
16384,   10,  0.1000,  0.1740,  0.2855,  0.4345,  0.5810,  0.7165,  0.7960,  0.8340,  0.8450,  0.8490,  0.8500,  0.8500,  0.8500,  0.8500,  0.8500,  0.8500,  0.8500,  0.8500,
16384,   20,  0.0500,  0.0910,  0.1605,  0.2695,  0.4183,  0.5827,  0.7137,  0.7940,  0.8170,  0.8235,  0.8245,  0.8248,  0.8248,  0.8248,  0.8248,  0.8248,  0.8248,  0.8248,
16384,   50,  0.0200,  0.0385,  0.0728,  0.1323,  0.2339,  0.3780,  0.5489,  0.6893,  0.7555,  0.7764,  0.7797,  0.7804,  0.7804,  0.7804,  0.7804,  0.7804,  0.7804,  0.7804,
16384,  100,  0.0100,  0.0198,  0.0380,  0.0726,  0.1346,  0.2380,  0.3919,  0.5650,  0.6864,  0.7344,  0.7444,  0.7464,  0.7464,  0.7464,  0.7464,  0.7464,  0.7464,  0.7464,
16384, 1000,  0.0010,  0.0020,  0.0040,  0.0080,  0.0158,  0.0312,  0.0614,  0.1179,  0.2164,  0.3631,  0.5128,  0.5795,  0.5870,  0.5872,  0.5872,  0.5872,  0.5872,  0.5872,
#
# probe 65536 items
# hierarchy_index [    0 65536]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
65536,    1,  0.9950,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,
65536,   10,  0.1000,  0.1790,  0.2935,  0.4475,  0.6170,  0.7815,  0.8865,  0.9455,  0.9670,  0.9725,  0.9745,  0.9745,  0.9745,  0.9745,  0.9745,  0.9745,  0.9745,  0.9745,
65536,   20,  0.0500,  0.0932,  0.1633,  0.2775,  0.4340,  0.6300,  0.7867,  0.9050,  0.9525,  0.9672,  0.9698,  0.9710,  0.9713,  0.9713,  0.9713,  0.9713,  0.9713,  0.9713,
65536,   50,  0.0200,  0.0389,  0.0733,  0.1341,  0.2378,  0.4009,  0.5940,  0.7866,  0.8979,  0.9455,  0.9584,  0.9608,  0.9612,  0.9612,  0.9612,  0.9612,  0.9612,  0.9612,
65536,  100,  0.0100,  0.0197,  0.0382,  0.0730,  0.1367,  0.2484,  0.4158,  0.6313,  0.8106,  0.9113,  0.9431,  0.9511,  0.9525,  0.9525,  0.9525,  0.9525,  0.9525,  0.9525,
65536, 1000,  0.0010,  0.0020,  0.0040,  0.0080,  0.0158,  0.0314,  0.0619,  0.1207,  0.2280,  0.4039,  0.6372,  0.8194,  0.8821,  0.8898,  0.8901,  0.8901,  0.8901,  0.8901,