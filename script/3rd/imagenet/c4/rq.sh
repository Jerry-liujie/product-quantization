# hpc2.cse.cuhk.edu.hk:/research/jcheng2/xinyan/github/product-quantization> python run_imi_iregualr_rq.py
# Parameters: dataset = imagenet, topK = 1000, Ks = 256, metric = euclid
# load the base data data/imagenet/imagenet_base.fvecs,
# load the queries data/imagenet/imagenet_query.fvecs,
# load the ground truth data/imagenet/1000_imagenet_euclid_groundtruth.ivecs
#    Training the subspace: 0 / 2, 0 -> 75
#    Training the subspace: 1 / 2, 75 -> 150
# compress items with imi
# train hierarchy rqs on residuals
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 0,  residual average norm : 0.17004922032356262 max norm: 0.7568134665489197 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 1,  residual average norm : 0.1564098596572876 max norm: 0.669793963432312 min norm: 0.0
#    Training the subspace: 0 / 1, 0 -> 150
# layer: 2,  residual average norm : 0.14641284942626953 max norm: 0.6519028544425964 min norm: 0.0
# compress items with rq
# compress norm
#    Training the subspace: 0 / 1, 0 -> 1
# imi full sort and generate candidate
# probe

# probe 16 items
# hierarchy_index [ 0 16]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
   16,    1,  0.2450,  0.2500,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,  0.2550,
   16,   10,  0.0275,  0.0295,  0.0320,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,  0.0325,
   16,   20,  0.0142,  0.0165,  0.0185,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,  0.0198,
   16,   50,  0.0063,  0.0081,  0.0094,  0.0103,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,  0.0105,
   16,  100,  0.0035,  0.0047,  0.0060,  0.0069,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,  0.0072,
   16, 1000,  0.0006,  0.0009,  0.0015,  0.0020,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,  0.0022,

# probe 256 items
# hierarchy_index [  0 256]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
  256,    1,  0.8450,  0.8800,  0.8850,  0.8900,  0.8900,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,  0.8950,
  256,   10,  0.0865,  0.1060,  0.1280,  0.1495,  0.1690,  0.1830,  0.1905,  0.1930,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,  0.1945,
  256,   20,  0.0435,  0.0548,  0.0703,  0.0910,  0.1100,  0.1247,  0.1340,  0.1365,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,  0.1375,
  256,   50,  0.0176,  0.0236,  0.0322,  0.0459,  0.0605,  0.0741,  0.0849,  0.0883,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,  0.0895,
  256,  100,  0.0088,  0.0126,  0.0186,  0.0281,  0.0394,  0.0526,  0.0633,  0.0674,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,  0.0687,
  256, 1000,  0.0010,  0.0017,  0.0030,  0.0052,  0.0088,  0.0141,  0.0209,  0.0265,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,  0.0284,

# probe 1024 items
# hierarchy_index [   0 1024]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
 1024,    1,  0.8800,  0.9200,  0.9450,  0.9550,  0.9600,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,  0.9700,
 1024,   10,  0.0915,  0.1115,  0.1430,  0.1770,  0.2225,  0.2645,  0.3090,  0.3405,  0.3515,  0.3535,  0.3540,  0.3540,  0.3540,  0.3540,  0.3540,  0.3540,  0.3540,  0.3540,
 1024,   20,  0.0462,  0.0595,  0.0808,  0.1095,  0.1462,  0.1885,  0.2337,  0.2700,  0.2865,  0.2905,  0.2908,  0.2908,  0.2908,  0.2908,  0.2908,  0.2908,  0.2908,  0.2908,
 1024,   50,  0.0188,  0.0257,  0.0376,  0.0551,  0.0809,  0.1146,  0.1528,  0.1925,  0.2164,  0.2252,  0.2259,  0.2259,  0.2259,  0.2259,  0.2259,  0.2259,  0.2259,  0.2259,
 1024,  100,  0.0094,  0.0137,  0.0217,  0.0339,  0.0525,  0.0791,  0.1149,  0.1516,  0.1790,  0.1909,  0.1918,  0.1918,  0.1918,  0.1918,  0.1918,  0.1918,  0.1918,  0.1918,
 1024, 1000,  0.0010,  0.0018,  0.0032,  0.0057,  0.0105,  0.0183,  0.0315,  0.0514,  0.0744,  0.0928,  0.0965,  0.0965,  0.0965,  0.0965,  0.0965,  0.0965,  0.0965,  0.0965,

# probe 4096 items
# hierarchy_index [   0 4096]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
 4096,    1,  0.8600,  0.9150,  0.9350,  0.9600,  0.9700,  0.9750,  0.9800,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,  0.9850,
 4096,   10,  0.0900,  0.1110,  0.1505,  0.1910,  0.2580,  0.3340,  0.4060,  0.4915,  0.5565,  0.5875,  0.5995,  0.6010,  0.6010,  0.6010,  0.6010,  0.6010,  0.6010,  0.6010,
 4096,   20,  0.0455,  0.0595,  0.0850,  0.1173,  0.1688,  0.2345,  0.3033,  0.3930,  0.4742,  0.5205,  0.5428,  0.5457,  0.5457,  0.5457,  0.5457,  0.5457,  0.5457,  0.5457,
 4096,   50,  0.0184,  0.0256,  0.0397,  0.0596,  0.0947,  0.1427,  0.2049,  0.2839,  0.3675,  0.4333,  0.4693,  0.4772,  0.4775,  0.4775,  0.4775,  0.4775,  0.4775,  0.4775,
 4096,  100,  0.0093,  0.0137,  0.0230,  0.0369,  0.0605,  0.0963,  0.1489,  0.2211,  0.3039,  0.3793,  0.4230,  0.4342,  0.4348,  0.4348,  0.4348,  0.4348,  0.4348,  0.4348,
 4096, 1000,  0.0010,  0.0017,  0.0032,  0.0059,  0.0111,  0.0203,  0.0369,  0.0645,  0.1080,  0.1684,  0.2319,  0.2679,  0.2726,  0.2726,  0.2726,  0.2726,  0.2726,  0.2726,

# probe 16384 items
# hierarchy_index [    0 16384]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
16384,    1,  0.8600,  0.9000,  0.9250,  0.9550,  0.9650,  0.9700,  0.9850,  0.9900,  0.9950,  0.9950,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,
16384,   10,  0.0905,  0.1100,  0.1485,  0.1940,  0.2585,  0.3630,  0.4455,  0.5540,  0.6680,  0.7605,  0.8210,  0.8460,  0.8530,  0.8540,  0.8540,  0.8540,  0.8540,  0.8540,
16384,   20,  0.0455,  0.0588,  0.0828,  0.1197,  0.1692,  0.2545,  0.3332,  0.4497,  0.5755,  0.6867,  0.7670,  0.8065,  0.8235,  0.8250,  0.8250,  0.8250,  0.8250,  0.8250,
16384,   50,  0.0184,  0.0251,  0.0393,  0.0610,  0.0968,  0.1534,  0.2233,  0.3283,  0.4535,  0.5825,  0.6869,  0.7520,  0.7764,  0.7806,  0.7807,  0.7807,  0.7807,  0.7807,
16384,  100,  0.0093,  0.0134,  0.0227,  0.0377,  0.0624,  0.1017,  0.1595,  0.2511,  0.3677,  0.4994,  0.6216,  0.7035,  0.7394,  0.7460,  0.7461,  0.7461,  0.7461,  0.7461,
16384, 1000,  0.0010,  0.0017,  0.0032,  0.0061,  0.0113,  0.0210,  0.0385,  0.0694,  0.1217,  0.2037,  0.3182,  0.4486,  0.5487,  0.5849,  0.5872,  0.5872,  0.5872,  0.5872,

# probe 65536 items
# hierarchy_index [    0 65536]
Probe, top-K, 00001.,  00002.,  00004.,  00008.,  00016.,  00032.,  00064.,  00128.,  00256.,  00512.,  01024.,  02048.,  04096.,  08192.,  16384.,  32768.,  65536.,  131072.,
65536,    1,  0.8550,  0.8900,  0.9300,  0.9550,  0.9650,  0.9700,  0.9850,  0.9900,  0.9950,  0.9950,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,  1.0000,
65536,   10,  0.0895,  0.1100,  0.1500,  0.1950,  0.2560,  0.3620,  0.4520,  0.5695,  0.6935,  0.8160,  0.8970,  0.9460,  0.9670,  0.9780,  0.9790,  0.9790,  0.9790,  0.9790,
65536,   20,  0.0452,  0.0588,  0.0833,  0.1202,  0.1678,  0.2525,  0.3375,  0.4588,  0.5970,  0.7322,  0.8380,  0.9107,  0.9485,  0.9698,  0.9740,  0.9740,  0.9740,  0.9740,
65536,   50,  0.0183,  0.0252,  0.0395,  0.0613,  0.0955,  0.1525,  0.2273,  0.3346,  0.4712,  0.6168,  0.7552,  0.8620,  0.9265,  0.9580,  0.9650,  0.9656,  0.9656,  0.9656,
65536,  100,  0.0092,  0.0135,  0.0228,  0.0377,  0.0615,  0.1018,  0.1627,  0.2549,  0.3808,  0.5289,  0.6839,  0.8122,  0.8979,  0.9424,  0.9539,  0.9555,  0.9555,  0.9555,
65536, 1000,  0.0010,  0.0017,  0.0032,  0.0060,  0.0112,  0.0209,  0.0386,  0.0699,  0.1234,  0.2108,  0.3409,  0.5089,  0.6823,  0.8183,  0.8828,  0.8952,  0.8956,  0.8956,